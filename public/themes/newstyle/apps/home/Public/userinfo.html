<include file="__THEME__/header" />
<link href="../Public/login.css" rel="stylesheet" type="text/css" />

<!--日期-->
<!--表单验证-->
<script type="text/javascript" src="__PUBLIC__/js/jquery.form.js"></script>
<script type="text/javascript" src="../Public/js/jquery.validator.reg.js"></script>
<script type="text/javascript" src="../Public/js/jquery.corners.min.js"></script>

<script type="text/javascript" src="../Public/js/register.js" ></script>
<div class="content_holder">
    <div class="content"><!-- 内容 begin  -->
        <div class="main no_l">
            <div class="mainbox boxspace">
                <div class="mainbox_appR">
                    <div class="reg_process">
                        <div class="reg_process_def"><div>1.验证身份</div></div>
                        <div class="reg_process_on"><div>2.填写基本信息</div></div>
                        <div class="reg_process_def"><div>3.看看推荐的人</div></div>
                        <div class="reg_process_def"><div>4.完成，进入我的首页</div></div>
                    </div>
                </div>
                <div class="mainbox_appC boxspace_L">
                    <div class="reg_box">
                        <div class="left lineS_btm" style="width:100%">

                            <h2 class="cBlue"><strong style="font-size:45px">02.</strong>完善个人资料，开通微博鲜事</h2>
                            <p class="cRed f16px" style="margin: 10px 0 20px 80px;">你已成功注册。</p>
                        </div>
                        <form action="{:U('home/Public/userinfo')}" method="post" id="regform" name="reg">
                            <php>if(!empty($invite)) {</php>
                            <php>}</php>

                            <ul class="form_list">
                                <li class="form_li">
                                    <div class="reg_li_1">站内昵称：<span class="cRed ">*</span></div>
                                    <div class="reg_li_2">
                                        <input type="text" name="nickname" value="{$nickname}" class="text35" style="width:250px;" min="2" max="10" maxLength="10" require="true" datatype="require|ajax" url="{:U('home/Public/isValidNickName')}" msg="重要！请填写昵称|昵称不符合要求或已被使用!" />
                                    </div>
                                    <div class="reg_li_3">
                                        <div id="success_nickname" style="display:none;">
                                            <span class="ico_cue_ok"></span>
                                        </div>
                                        <div class="error_nickname" style="position: relative;display:none;">
                                            <span class="ico_cue_no"></span><span id="error_nickname"></span>
                                        </div>
                                    </div>
                                    <br/><div style="padding-left:95px;">(注: 昵称只能由2-10位个中英文、数字、下划线和中划线组成)</div>
                                </li>
                                <li class="form_li">
                                    <div class="reg_li_1">新密码：<span class="cRed ">*</span></div>
                                    <div class="reg_li_2">
                                        <input type="password" name="password" value="" class="text35" style="width:250px;" min="6" max="16" maxLength="30" require="true" datatype="require" msg="重要！请填写密码" />
                                    </div>
                                    <div class="reg_li_3">
                                        <div id="success_password" style="display:none;">
                                            <span class="ico_cue_ok"></span>
                                        </div>
                                        <div class="error_password" style="position: relative;display:none;">
                                            <span class="ico_cue_no"></span><span id="error_password"></span>
                                        </div>
                                    </div>
                                    <br/><div style="padding-left:95px;">(注: 密码为6-16位字符，不可跟原始密码一致)</div>
                                </li>
                                <li class="form_li">
                                    <div class="reg_li_1">确认密码：<span class="cRed ">*</span></div>
                                    <div class="reg_li_2">
                                        <input type="password" name="repassword" value="" class="text35" style="width:250px;" min="6" max="16" maxLength="30" require="true" datatype="require" msg="重要！请确认密码" />
                                    </div>
                                    <div class="reg_li_3">
                                        <div id="success_repassword" style="display:none;">
                                            <span id="p_yes"></span>
                                        </div>
                                        <div class="error_repassword" style="position: relative;display:none;">
                                            <span class="ico_cue_no"></span><span id="error_repassword"></span>
                                        </div>
                                    </div>
                                </li>

                                <li class="form_li">
                                    <div class="reg_li_1">密保邮箱：<span class="cRed ">*</span></div>
                                    <div class="reg_li_2">
                                        <input type="text" name="email2" value="{$user['email2']}" class="text35" id="email2" style="width:250px;" min="1" max="50" maxLength="50" require="true" datatype="require" msg="重要！请填写邮箱号!" />
                                    </div>
                                    <div class="reg_li_3">
                                        <div id="success_email2" style="display:none;">
                                            <span id="yes"></span>
                                        </div>
                                        <div class="error_email2" style="position: relative;display:none;">
                                            <span class="ico_cue_no"></span><span id="error_email2"></span>
                                        </div>
                                    </div>
                                      <br/><div style="padding-left:95px;">(注:设置密保邮箱能帮助您在忘记密码的时候取回您的登录密码，请仔细填写)</div>
                                </li>
                                <li class="form_li">
                                    <div class="reg_li_1">手机号码：</div>
                                    <div class="reg_li_2">
                                        <input type="text" name="mobile" value="{$user['mobile']}" class="text35" id="mobile" style="width:250px;" maxLength="11"/>
                                    </div>
                                </li>
                                <li class="form_li">
                                    <div class="reg_li_1">性别：</div>
                                    <div class="reg_li_2">
                                        <label><input name="sex" type="radio" value="1"  checked /> 男</label> &nbsp;&nbsp;&nbsp;
                                        <label><input name="sex" type="radio" value="0" /> 女</label>
                                    </div>
                                </li>
                                <li class="form_li">
                                    <div class="reg_li_1">&nbsp;</div><div class="reg_li_2">
                                        <input type="submit" class="btn_green_w121 hand" value="创建帐号">
                                    </div>
                                </li>
                            </ul>
                        </form>
                    </div>
                    <div class="c"></div>
                </div>
            </div>
            <div class="clear"></div>
        </div>
    </div>
</div>
<script>
    var sid = {$editSid};
    function selectSchool(){
        var typevalue = $("#current").val();
        ui.box.load(U('home/Public/multiSchool')+'&selected='+typevalue+'&sid='+sid,{title:'选择学校',noCheck:'yes'});
    }
    $(function(){

        $("input[name='repassword']").blur(function(){
            checkPassword();
        });
        $('#email2').blur(function(){
            checkEmail();
        });

        $('form').submit(function(){
            if(checkPassword()){
                return checkEmail();
            }else{
                return false;
            }
        });

    });
    function checkEmail(){
        var myreg = /^([a-za-z0-9]+[_|_|.]?)*[a-za-z0-9]+@([a-za-z0-9]+[_|_|.]?)*[a-za-z0-9]+.[a-za-z]{2,3}$/;
        var email = $('#email2').val();
        var stat=false;
        if(email){
            if(myreg.test(email)){
                $.ajax({
                    type:"POST",
                    url:"{:U('home/Public/checkMail')}",
                    async:false,
                    data:"email="+email,
                    success:function(data){
                        var json =$.parseJSON(data);
                        if (json.status ==0) {
                            $('#yes').hide();
                            $('.error_email2').show();
                            $('#error_email2').html("<font color='red'>"+json.info+"</font>");
                            stat=false;
                        }else{
                            $('#yes').show();
                            $('#yes').addClass('ico_cue_ok');
                            stat=true;
                        }
                    }
                });
            }else{
                $('#yes').hide();
                $('.error_email2').show();
                $('#error_email2').html("<font color='red'>邮箱格式错误</font>");
                stat=false;
            }
        }
        return stat;
    }
    function checkPassword(){
        var password=$("input[name='password']").val();
        var repassword= $("input[name='repassword']").val();
        if(repassword&&password!=repassword){
            $('#p_yes').hide();
            $('.error_repassword').show();
            $('#error_repassword').html("<font color='red'>密码不一致</font>");
            return false
        }else{
            $('#p_yes').show();
            $('#p_yes').addClass('ico_cue_ok')
            return true;
        }
    }

</script>
<include file="__THEME__/footer" />
